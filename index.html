<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Batalla Naval Patagonian</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <header>
    <div id="game-status" role="status" aria-live="polite">Colocá tus barcos para comenzar</div>
    <div id="turn-indicator" role="status" aria-live="polite" hidden></div>
  </header>

  <section id="home-screen">
    <button id="btn-rules" type="button" class="btn-rules" aria-label="Ver reglas del juego">?</button>
    <h1>Batalla Naval Patagonian</h1>
    <p class="home-description">Hundir la flota enemiga antes de que hundan la tuya.<br>Para dos jugadores en tiempo real.</p>
    <button id="btn-play" type="button">Jugar</button>
  </section>

  <section id="lobby" hidden>
    <div class="player-name-group">
      <label for="input-player-name">Tu nombre</label>
      <input id="input-player-name" type="text" maxlength="20" placeholder="Jugador 1" autocomplete="off">
    </div>
    <button id="btn-create-room" type="button">Crear sala</button>
    <div class="lobby-divider">— o —</div>
    <form id="join-form">
      <input id="input-room-code" type="text" maxlength="6" placeholder="Código de sala" autocomplete="off">
      <button type="submit">Unirse</button>
    </form>
    <div id="room-code-display" hidden>
      <span id="room-code-value"></span>
      <button id="btn-copy-code" type="button" aria-label="Copiar código">Copiar</button>
      <p>Comparte este código con tu oponente</p>
    </div>
    <div id="lobby-status" aria-live="polite"></div>
    <div id="loading-spinner" hidden aria-label="Conectando..." role="status">
      <div class="spinner"></div>
      <span class="spinner-text">Conectando...</span>
    </div>
  </section>

  <main id="game-container" hidden>
    <!-- Columna del jugador local -->
    <section class="board-column" id="player-column">
      <h2>Tu tablero</h2>

      <!-- Fase de colocación -->
      <section id="placement-phase" aria-label="Fase de colocación de barcos">
        <nav id="ship-list" aria-label="Barcos disponibles">
          <button class="ship-item" data-ship-id="carrier" data-ship-size="5" type="button" aria-label="Portaaviones - 5 celdas">
            <span class="ship-name">Portaaviones</span>
            <span class="ship-cells">
              <span class="ship-cell-block"></span><span class="ship-cell-block"></span><span class="ship-cell-block"></span><span class="ship-cell-block"></span><span class="ship-cell-block"></span>
            </span>
          </button>
          <button class="ship-item" data-ship-id="battleship" data-ship-size="4" type="button" aria-label="Acorazado - 4 celdas">
            <span class="ship-name">Acorazado</span>
            <span class="ship-cells">
              <span class="ship-cell-block"></span><span class="ship-cell-block"></span><span class="ship-cell-block"></span><span class="ship-cell-block"></span>
            </span>
          </button>
          <button class="ship-item" data-ship-id="cruiser" data-ship-size="3" type="button" aria-label="Crucero - 3 celdas">
            <span class="ship-name">Crucero</span>
            <span class="ship-cells">
              <span class="ship-cell-block"></span><span class="ship-cell-block"></span><span class="ship-cell-block"></span>
            </span>
          </button>
          <button class="ship-item" data-ship-id="submarine" data-ship-size="3" type="button" aria-label="Submarino - 3 celdas">
            <span class="ship-name">Submarino</span>
            <span class="ship-cells">
              <span class="ship-cell-block"></span><span class="ship-cell-block"></span><span class="ship-cell-block"></span>
            </span>
          </button>
          <button class="ship-item" data-ship-id="destroyer" data-ship-size="2" type="button" aria-label="Destructor - 2 celdas">
            <span class="ship-name">Destructor</span>
            <span class="ship-cells">
              <span class="ship-cell-block"></span><span class="ship-cell-block"></span>
            </span>
          </button>
        </nav>
        <div class="placement-controls">
          <button id="btn-orientation" type="button" aria-pressed="false" aria-label="Orientación: Horizontal">H</button>
          <button id="btn-random" type="button">Aleatorio</button>
          <button id="btn-ready" type="button" disabled>Listo</button>
        </div>
      </section>

      <!-- Tablero del jugador -->
      <div class="board-wrapper">
        <div id="player-board" class="board" role="grid" aria-label="Tu tablero de juego">
        </div>
      </div>
    </section>

    <!-- Columna del enemigo -->
    <section class="board-column" id="enemy-column">
      <h2>Tablero enemigo</h2>
      <div class="board-wrapper">
        <div id="enemy-board" class="board" role="grid" aria-label="Tablero del enemigo">
        </div>
      </div>
    </section>

    <section id="fleet-status" hidden aria-label="Estado de flotas">
      <div id="player-fleet" class="fleet-panel">
        <h3>Tu Flota</h3>
        <ul class="fleet-list" aria-label="Estado de tu flota"></ul>
      </div>
      <div id="enemy-fleet" class="fleet-panel">
        <h3>Flota Enemiga</h3>
        <ul class="fleet-list" aria-label="Estado de la flota enemiga"></ul>
      </div>
    </section>

    <section id="attack-history" hidden aria-label="Historial de ataques">
      <h3>Últimos movimientos</h3>
      <ol id="attack-history-list"></ol>
    </section>
  </main>

  <section id="end-screen" hidden>
    <div id="end-result"></div>
    <div id="end-stats">
      <span id="stat-attacks"></span>
      <span id="stat-accuracy"></span>
      <span id="stat-duration"></span>
    </div>
    <div id="end-buttons">
      <button id="btn-rematch">Revancha</button>
      <button id="btn-exit">Salir</button>
    </div>
  </section>

  <div id="rules-modal" hidden role="dialog" aria-modal="true" aria-labelledby="rules-title">
    <div class="rules-overlay"></div>
    <div class="rules-dialog">
      <h2 id="rules-title">Reglas del Juego</h2>
      <button id="btn-close-rules" type="button" aria-label="Cerrar reglas">&times;</button>
      <section class="rules-section">
        <h3>Objetivo</h3>
        <p>Hundir toda la flota enemiga antes de que hundan la tuya. Los jugadores se turnan para atacar celdas del tablero oponente.</p>
      </section>
      <section class="rules-section">
        <h3>Fases</h3>
        <ol>
          <li><strong>Lobby:</strong> Crear o unirse a una sala con el código de 6 caracteres.</li>
          <li><strong>Colocación:</strong> Colocá tus 5 barcos en el tablero. Podés elegir orientación o usar "Aleatorio".</li>
          <li><strong>Combate:</strong> Por turnos, hacé clic en una celda del tablero enemigo para atacar.</li>
          <li><strong>Fin:</strong> Quien hunda toda la flota enemiga primero, gana.</li>
        </ol>
      </section>
      <section class="rules-section">
        <h3>Barcos</h3>
        <ul class="rules-ships">
          <li><span class="rules-ship-name">Portaaviones</span><span class="rules-ship-size">5 celdas</span></li>
          <li><span class="rules-ship-name">Acorazado</span><span class="rules-ship-size">4 celdas</span></li>
          <li><span class="rules-ship-name">Crucero</span><span class="rules-ship-size">3 celdas</span></li>
          <li><span class="rules-ship-name">Submarino</span><span class="rules-ship-size">3 celdas</span></li>
          <li><span class="rules-ship-name">Destructor</span><span class="rules-ship-size">2 celdas</span></li>
        </ul>
      </section>
    </div>
  </div>

  <script type="module" src="js/placement.js"></script>
  <script type="module" src="js/firebase-game.js"></script>
  <script type="module" src="js/game.js"></script>
</body>
</html>
